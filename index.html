<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Document</title>
</head>
<body>
	<script src="engine/Container.js"></script>
	<script src="engine/Loader.js"></script>
	<script src="engine/Renderer.js"></script>
	<script src="engine/Sprite.js"></script>
	<script>
		
		// вытаскиваем классы из GameEngine
		const { Loader, Renderer, Sprite, Container } = GameEngine

		let sprite = null
		let monkey = null

		const loader = new Loader
		const renderer = new Renderer({
			width: 500,
			height: 500,
			background : 'gray',

			update (timestamp) {
				if (sprite) {
					sprite.x = renderer.canvas.width / 2 + 100 * Math.cos(timestamp / 200)
					sprite.y = renderer.canvas.height / 2 + 100 * Math.sin(timestamp / 200)
					sprite.frame.x = sprite.texture.width / 2 + 100 * Math.cos(timestamp / 200)
					sprite.frame.y = sprite.texture.height / 2 + 100 * Math.sin(timestamp / 200)
				}
				if (monkey) {
					if ( monkey.x < renderer.canvas.width) {
						monkey.x = timestamp / 20
					}

				}
			}
		})

		document.body.append(renderer.canvas)

		loader.addImage('animal', 'static/animal.jpg')
		loader.addImage('monkey', 'static/monkey.jpg')
		loader.addJson('persons', 'static/persons.json')
		loader.addJson('animals', 'static/animals.json')


		loader.load(() => {
			// выводим изображения на страницу
			// стартовая инициализация спрайта
			sprite = new Sprite(loader.getImage('animal'), {
				scale: 0.25,
				anchorX: 0.5,
				anchorY: 0.5
			})

			const container = new Container()
			renderer.stage.add(container)
			container.add(sprite)

			// задаём точку позиционирования
			sprite.absoluteX = 0
			sprite.absoluteY = 0

			monkey = new Sprite(loader.getImage('monkey'), {
				scale: 0.25,
				anchorX: 0.5,
				anchorY: 0.5
			})

			container.add(monkey)

			monkey.absoluteX = 50
			monkey.absoluteY = 50

		})

	</script>
</body>
</html>